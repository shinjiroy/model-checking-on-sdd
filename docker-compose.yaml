# Spec Kit Model Checking Extension - Alloy Docker Environment
#
# Usage:
#   docker compose build alloy-verify    # Build image
#   docker compose run --rm alloy-verify ...  # Run verification
#
# Default context: docker/alloy/
# Customization: Set ALLOY_DOCKER_DIR environment variable
#   Example: ALLOY_DOCKER_DIR=.specify/docker/alloy docker compose build alloy-verify

services:
  # Alloy verification service
  alloy-verify:
    profiles: ["alloy"]
    build:
      context: ${ALLOY_DOCKER_DIR:-./docker/alloy}
      dockerfile: Dockerfile
    volumes:
      # Mount Spec Kit specs directory (read-only)
      - ./specs:/specs:ro
    working_dir: /specs
    stdin_open: true
    tty: true

  # Development: Shell access to Alloy environment
  alloy-shell:
    profiles: ["alloy"]
    build:
      context: ${ALLOY_DOCKER_DIR:-./docker/alloy}
      dockerfile: Dockerfile
    volumes:
      - ./specs:/specs
    working_dir: /specs
    entrypoint: ["/bin/sh"]
    stdin_open: true
    tty: true
