# Spec Kit 形式検証拡張 - Alloy Docker環境
#
# デフォルト配置: docker/alloy/
# カスタマイズ: ALLOY_DOCKER_DIR 環境変数で変更可能
#   例: ALLOY_DOCKER_DIR=.specify/docker/alloy docker-compose build

services:
  # Alloy検証サービス
  alloy-verify:
    build:
      context: ${ALLOY_DOCKER_DIR:-./docker/alloy}
      dockerfile: Dockerfile
    volumes:
      # Spec Kitのspecsディレクトリをマウント
      - ./specs:/specs:ro
      # 検証結果を出力するディレクトリ
      - ./verification-results:/results
    working_dir: /specs
    stdin_open: true
    tty: true

  # 開発用: Alloy環境にシェルでアクセス
  alloy-shell:
    build:
      context: ${ALLOY_DOCKER_DIR:-./docker/alloy}
      dockerfile: Dockerfile
    volumes:
      - ./specs:/specs
    working_dir: /specs
    entrypoint: ["/bin/sh"]
    stdin_open: true
    tty: true
